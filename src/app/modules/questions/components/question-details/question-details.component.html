<div *ngIf="question">
  <div class="d-flex justify-content-between">
    <h2>{{question.id ? '#'+question.id : 'New Question'}}</h2>
    <button *ngIf="!editMode" type="button" class="btn btn-link" (click)="editMode = true">
      <span class="oi oi-pencil"></span>
    </button>
  </div>
  <div class="d-flex justify-content-between text-muted">
    <div *ngIf="question.id">
      <span>{{question.created_by}}</span> &middot;
      <span>{{question.created_on | date:'short'}}</span>
    </div>
    <div *ngIf="!editMode">
      <span class="text-uppercase">Difficulty</span>
      <ngb-rating [rate]="question.difficulty" [max]="5" [readonly]="true"></ngb-rating>
    </div>
  </div>
  <div *ngIf="!editMode">
    <p>{{question.text}}</p>
    <p class="ml-5 text-primary">{{question.answer}}<span *ngIf="question.alternate_answer"> <span class="font-weight-bold">or</span> {{question.alternate_answer}}</span></p>
    <hr />
    <ul class="list-inline mb-0">
      <li *ngFor="let tag of question?.tags"
          class="list-inline-item badge badge-primary">
        {{tag}}
      </li>
    </ul>
  </div>
  <form *ngIf="!question.id || editMode" [formGroup]="questionForm" (ngSubmit)="onSubmit()" novalidate>
    <div class="form-group">
      <label>Question</label>
      <textarea class="form-control" rows="3" formControlName="text"></textarea>
    </div>
    <div class="form-group">
      <label>Answer Widget</label>
      <select class="form-control" #answerWidget formControlName="answer_widget">
        <option *ngFor="let widget of answer_widgets"
                [value]="widget.value">{{widget.name}}</option>
      </select>
    </div>
    <div [ngSwitch]="answerWidget.value">
      <div class="form-group">
        <label>Answer</label>
        <div class="form-row">
          <div class="col">
            <input [type]="answerWidget.value" class="form-control" placeholder="Answer" formControlName="answer">
          </div>
          <div class="col">
            <input [type]="answerWidget.value" class="form-control" placeholder="Alternate" formControlName="alternate_answer">
          </div>
        </div>
      </div>
    </div>
    <div class="form-group">
      <label>Difficulty</label>
      <select class="form-control" formControlName="difficulty">
        <option *ngFor="let difficulty of difficulties"
                [value]="difficulty.value">{{difficulty.name}}</option>
      </select>
    </div>
    <div class="form-group">
      <label>Tags</label>
      <textarea class="form-control" rows="2" formControlName="tags"></textarea>
    </div>
    <button type="submit"
            [disabled]="questionForm.pristine"
            class="btn btn-success">Save</button> &nbsp;
    <button type="reset" (click)="revert()"
            [disabled]="questionForm.pristine"
            class="btn btn-warning">Revert</button> &nbsp;
    <button type="cancel" (click)="revert()"
            class="btn btn-danger">Cancel</button>
  </form>
</div>